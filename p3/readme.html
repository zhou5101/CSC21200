<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <title>212 Project 3 – Binary Search Tree</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style type="text/css">
  body 
  {
  	font-family:Gill Sans MT;
  	color:#657b83;
  	background-color:#fdf6e3;
  	max-width:500pt;
  	padding-left:25pt;
  	padding-right:25pt;
  	padding-bottom:20pt;
  	margin:0 auto 0 auto;
  	text-align:justify;
  }
  a:link {color:#6c71c4;}
  a:visited {color:#859900;}
  a:hover {color:#268bd2;}
  a:active {color:#d33682;}
  h1{}
  h2{border-style:solid;
   text-align:center;
  }
  h3
  {
  	margin-bottom:2pt;
  	/*color:#268bd2;*/
  	font-weight:bold;
  }
  strong
  {
  	color:#d33682;
  	font-weight:bolder;
  }
  em
  {
  	color:#268bd2;
  	font-style:italic;
  	font-weight:bolder;
  }
  code
  {
      background-color:#eee8d5;
      color:#586e75;
  }
  table.sourceCode
  {
      background-color:#eee8d5;
      color:#586e75;
  }
  pre.sourceCode
  {
      background-color:#eee8d5;
      color:#586e75;
  }
  .math
  {
      /*background-color:#eee8d5;*/
      color:#586e75;
      font-family:Times New Roman;
  }
  /*use a contextual style to undo the blue-ness:*/
  .math em
  {
      color:#586e75;
  	font-weight:normal;
  }
  .descrip
  {
  	max-width:500pt;
  	padding-left:25pt;
  	text-align:justify;
  }
  .descripbig
  {
  	max-width:575pt;
  	padding-left:0pt;
  	text-align:justify;
  }
  .emph
  {
  	color:#d33682;
  	font-weight:bolder;
  }
  .litem
  {
  	color:#268bd2;
  	font-style:italic;
  	font-weight:bolder;
  }
  .hl
  {
  	color:#268bd2;
  	font-style:italic;
  }
  .required
  {
  	color:#268bd2;
  	font-style:italic;
  	font-weight:bold;
  }
  .inputbox
  {
  	background-color:#eee8d5;
  	color:#586e75;
  	font-family:Gill Sans MT;
  	font-weight:bolder;
  }
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">212 Project 3 – Binary Search Tree</h1>
<p class="author"></p>
</header>
<h2 id="due-sunday-april-12th-1159pm"><em>Due:</em> Sunday, April 12th @ 11:59pm</h2>
<h2 id="synopsis">Synopsis</h2>
<p>Implement a binary search tree.</p>
<h2 id="important-notes-on-grading">Important Notes on Grading</h2>
<p>I would like you all to collaborate on these projects in small teams. Teams <strong>must have 3 – 4 people</strong>. As usual:</p>
<ul>
<li>Everyone should be signed up on <a href="https://bitbucket.org/">bitbucket</a>.</li>
<li>Designate one member of your team to be the leader / repository owner. (They’ll set up the repository and grant access to the rest of the team.)</li>
<li>Commits from the team members can be incorporated in one of two ways:
<ol type="1">
<li>Follow the instructions on <a href="http://www-cs.ccny.cuny.edu/~wes/CSC212S17/scm.html#collaborate">collaborating with git</a>. (Team leaders: don’t forget to give other members write access to the repository.)</li>
<li>Use <a href="https://www.atlassian.com/git/tutorials/making-a-pull-request/example">bitbucket’s fork + pull request</a> features.</li>
</ol>
<strong>NOTE:</strong> Either way you do it, you should follow the guidelines given above about <a href="http://www-cs.ccny.cuny.edu/~wes/CSC212S17/scm.html#collaborate">avoiding merge conflicts</a>.</li>
<li>Team leaders – please <em>edit</em> (or start, if it doesn’t exist) a piazza post containing the url of your repository, and a list of the team’s members.</li>
<li>I’ll grade the projects based on whether or not they pass the automated tests, and whether or not each team member is contributing (as evidenced by the commit logs).</li>
</ul>
<h2 id="details">Details</h2>
<p>As usual, there is a skeleton file (which should compile) that you should complete. All the functions you have to write are labeled with <code>TODO</code>. A few remarks are in order:</p>
<ul>
<li>When writing <code>remove</code>, please perform the operation by placing the <em>successor</em> at the location of the removed node when handling the case of a node with two children. It’s obviously not the only correct way to do it, but it will let you check your output against mine.</li>
<li>We are using <em>templates</em> this time. This might take a little getting used to, but I’m sure you are up to the task. Ask if/when you have questions. Also take note of the comments in the skeleton source.</li>
<li>Make sure you do the bonus exercises on “const correctness” unless you are somehow already an expert.</li>
<li>The prototype I’ve given of <code>operator=</code> suggests you use the technique of letting the copy constructor do all the work and then stealing its result. Review our <code>vector</code> code from lecture if you need a reminder.</li>
<li>I defined the height of the empty tree to be -1. Please adopt the same convention for ease of testing.</li>
</ul>
<h3 id="compiling">Compiling</h3>
<p>This is easy:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a>$ <span class="fu">make</span>  <span class="co"># compile project</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>$ <span class="fu">make</span> debug  <span class="co"># same, but with debugging symbols + assertions</span></span></code></pre></div>
<p><em>Note:</em> use <code>make -B [debug]</code> to force recompilation when switching from a normal build to debug (or vice versa).</p>
<h3 id="testing">Testing</h3>
<h4 id="manual-testing">Manual testing</h4>
<p>This is maybe easy. The main program reads commands from <code>stdin</code> and modifies a single binary search tree of unsigned long integers. To see how to use it, run <code>./main --help</code>. I’ve also prepared some test files for you. Some examples that might be of interest:</p>
<p>Make a tiny tree and draw it:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a>$ <span class="bu">echo</span> i 5 i 2 i 1 i 3 i 9 i 7 i 13 d <span class="kw">|</span> <span class="ex">./main</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="ex">svg</span> output written to /tmp/trees-axFXI7/</span></code></pre></div>
<p>Then you’ll have the following svg in that <code>/tmp/trees-XXXXXX/</code> directory:</p>
<p><img src="t8.svg" alt="bstree" /><br />
</p>
<p><strong>NOTE:</strong> the above assumes you have <a href="http://www.graphviz.org/Download.php">graphviz</a>. It’s on the virtual machine for my 103 course, but also available from just about any Linux distribution’s official repositories. Highly recommended. Also note that you of course have to have written <code>insert</code> and <code>postorder</code> for this much to work, but both are pretty easy. Lastly note that <code>./main</code> without <code>-c</code> should generally work fine even if you don’t have a valid copy constructor or assignment operator.</p>
<p>It might also be useful to make a file of commands that builds a specific tree. To make a random tree with values 1-20:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a>$ <span class="kw">for</span> <span class="ex">i</span> in <span class="dt">{1..20}</span><span class="kw">;</span> <span class="kw">do</span> <span class="bu">printf</span> <span class="st">&quot;i %i\n&quot;</span> <span class="va">$i</span> <span class="kw">;</span> <span class="kw">done</span> <span class="kw">|</span> <span class="ex">shuf</span> <span class="op">&gt;</span> /tmp/input</span></code></pre></div>
<p>You could then build the tree and print some statistics like this:</p>
<pre><code>$ echo S l m M h | cat /tmp/input - | ./main
#nodes == 20
#leaves == 7
min(T) == 1
max(T) == 20
height == 5</code></pre>
<p>And if you wanted to use that tree as a starting point, but enter further commands interactively:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a>$ <span class="fu">cat</span> /tmp/input - <span class="kw">|</span> <span class="ex">./main</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="ex">p</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="ex">11</span> 7 6 5 2 1 4 3 9 8 10 20 15 12 13 14 19 16 18 17</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="ex">s</span> 99</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="ex">99</span> was not in the tree.</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="ex">s</span> 15</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="ex">15</span> was in the tree.</span></code></pre></div>
<p>Again, see the output of <code>./main --help</code> for a list of the commands.</p>
<h4 id="copy-and-assignment">Copy and assignment</h4>
<p>There’s also a <code>-c</code> option to help you test the copy constructor and assignment operator. It just makes a random-ish tree, copies it via the various means available, and prints the resulting trees in preorder. The first test is whether or not <code>./main -c</code> crashed. Barring seg faults and the like, you could then examine the output and make sure each tree had the same contents. Lazy and somewhat imprecise method: run the following and make sure output is 1:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a>$ <span class="ex">./main</span> -c <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="kw">|</span> <span class="fu">wc</span> -l</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="ex">1</span></span></code></pre></div>
<h4 id="semi-automated-testing">Semi-automated testing</h4>
<p>You can find the output of my solution for each file in <code>test-input/</code> in the directory <code>test-input/reference-output/</code>. If you just want to see if you got the same answers as I did:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a>$ <span class="ex">vimdiff</span> <span class="op">&lt;(</span><span class="ex">./main</span> <span class="op">&lt;</span>test-input/search<span class="op">)</span> test-input/reference-output/search</span></code></pre></div>
<p>Alternatively, you could <code>sha1sum</code> them, etc. I’ll leave writing a test script as a simple exercise for you.</p>
<h3 id="debugging">Debugging</h3>
<p>If you have a seg fault or similar runtime error, perhaps consider running <code>make -B debug</code> and letting <code>gdb</code> give you a hand. If your program does not crash, but produces output that is inconsistent with mine, then you may want to examine the evolution of your tree after every insert / remove. For that, maybe try something like the following:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a>$ <span class="fu">awk</span> <span class="st">&#39;{print $0} /^[ir]/ {print &quot;d&quot;}&#39;</span> test-input/insert <span class="kw">|</span> <span class="ex">./main</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="ex">svg</span> output written to /tmp/trees-XXXXXX/</span></code></pre></div>
<p>The SVG files will be numbered according to the index of the command, so if you open them in ascending order, you can watch your tree evolve. This ought to make debugging not too painful.</p>
<h3 id="hints-and-notes">Hints and notes</h3>
<h4 id="using-recursion">Using recursion</h4>
<p>I plan on you writing most of these functions recursively.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To facilitate the recursive approach, there are a bunch of functions that take node pointers, e.g.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">template</span> &lt;<span class="kw">typename</span> K&gt;</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="dt">void</span> insert(node&lt;K&gt;*&amp; n, K x);</span></code></pre></div>
<p>You might be wondering why we don’t just use member functions of the tree? Well, recursion usually works by building a global solution out of solutions to smaller sub-problems. If using member functions, we are met with an annoying technical obstacle: the subtrees are defined just by pointers, not by things of type <code>tree</code>. So the natural sub-problems you want to solve aren’t quite of the same shape as the global one. Hence the existence of the functions with node pointer input. Most <code>tree</code> member functions will simply give their root pointer to the corresponding function that acts on nodes, e.g.:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">template</span> &lt;<span class="kw">typename</span> K&gt;</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="dt">void</span> tree&lt;K&gt;::insert(K x)</span>
<span id="cb10-3"><a href="#cb10-3"></a>{</span>
<span id="cb10-4"><a href="#cb10-4"></a>  ::insert(<span class="kw">this</span>-&gt;root,x);</span>
<span id="cb10-5"><a href="#cb10-5"></a>}</span></code></pre></div>
<h4 id="where-to-begin">Where to begin</h4>
<p>Try writing <code>insert</code> and <code>postorder</code>, <code>preorder</code>, <code>inorder</code> before anything else. They’re not too difficult, and they let you start testing as soon as possible.</p>
<h4 id="using-function-pointers">Using function pointers</h4>
<p>Think about using the traversal functions with clever inputs to solve some of the other problems. There’s a very natural solution for <code>clear</code> using <code>postorder</code>, for example. And if you think about it, you could also solve some of the statistics functions (e.g. <code>leaves</code> and <code>size</code>) using traversals.</p>
<h2 id="looking-for-more">Looking for more?</h2>
<p>In case you get bored, a few other things to try:</p>
<ul>
<li>Re-write the whole project from scratch. Don’t refer to the skeleton at all.</li>
<li>Try to understand completely how the skeleton produces the SVG files (modulo a complete understanding of <a href="http://www.graphviz.org/Download.php">graphviz</a>).</li>
<li>Verify that <code>gcc</code> is actually optimizing your recursion into loops. (You can get annotated assembly listings with the flags <code>-S -fverbose-asm</code>). Were there any functions that remained recursive after optimization?</li>
<li>If you are feeling super-ambitious, try (in a separate branch in your repository!) to convert the tree into a self-balancing tree, for example a <a href="https://en.wikipedia.org/wiki/Red%E2%80%93black_tree">red-black tree</a>.</li>
</ul>
<h2 id="submission-procedure">Submission Procedure</h2>
<p>Just make sure your group is listed on Piazza before the deadline.</p>
<!--  links  -->
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>With <code>-O2</code>, <code>gcc</code> will usually optimize the recursive calls into loops, so there isn’t going to be much of a performance cost.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
